<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Thomas F. Officer | Portfolio</title>
  <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet" type="text/css" />
  <link rel="icon" href="{{ url_for('static', filename='assets/tfo-favicon.ico') }}" type="image/x-icon">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
  {% include 'navbar.html' %}
  <div class="body__wrapper">
    {% include 'header.html' %}
    <main>
      <div class="main__wrapper">
        <p>
          Currently exploring. Previously, Principal Product Designer at <a href="https://www.netdocuments.com/ndmax" target="_blank">NetDocuments</a>, cofounder at <a href="https://afterpattern.com/" target="_blank">Afterpattern</a> (acquired 2021), and Design Fellow at the <a href="https://www.labs.robinhood.org/" target="_blank">Blue Ridge Labs @ Robin Hood</a> incubator (2016).
        </p>
        <div class="chat-display" id="chatDisplay">
          <p id="welcomeMessage" class="chatbot-message">Greetings! I'm Ward, an AI chatbot. I know (almost) everything about Thomas' career and professional ambitions. Ask away.</p>
        </div>
        <div class="chatbot">
          <div id="chatDisplay" class="chat-display"></div>
          <input type="text" id="userMessage" placeholder="Type a message...">
          <button onclick="sendUserMessage()">Send</button>
          <div id="spinner" class="spinner" style="display: none;"></div>
        </div>
      </div>
    </main>
  </div>
  <script>
    function sendUserMessage() {
      var message = document.getElementById('userMessage').value;
      var sendButton = document.querySelector('button[onclick="sendUserMessage()"]');

      // Hide the welcome message on first user input
      var welcomeMessage = document.getElementById('welcomeMessage');
      if (welcomeMessage) {
          welcomeMessage.style.display = 'none';
      }

      // Show spinner and disable send button
      document.getElementById('spinner').style.display = 'block';
      sendButton.disabled = true;

      sendMessageToChatbot(message);
      document.getElementById('chatDisplay').innerHTML += "<p>You: " + message + "</p>";
      document.getElementById('userMessage').value = "";
    }
  
    function sendMessageToChatbot(message) {
      $.ajax({
        url: '/ask_chatbot',
        type: 'POST',
        contentType: 'application/json',
        data: JSON.stringify({ 'message': message }),
        success: function(response) {
          var chatDisplay = document.getElementById('chatDisplay');
          chatDisplay.innerHTML += "<p>Bot: " + response.reply + "</p>";
          // Hide spinner and enable send button
          document.getElementById('spinner').style.display = 'none';
          document.querySelector('button[onclick="sendUserMessage()"]').disabled = false;
        },
        error: function(error) {
          console.log(error);
          // Hide spinner and enable send button
          document.getElementById('spinner').style.display = 'none';
          document.querySelector('button[onclick="sendUserMessage()"]').disabled = false;
        }
      });
    }
  </script>  
</body>
</html>